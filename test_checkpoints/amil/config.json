{
  "amil_config": {
    "code_embedding_dim": 768,
    "api_feature_dim": 20,
    "entropy_feature_dim": 5,
    "phase_feature_dim": 3,
    "metadata_feature_dim": 10,
    "unit_embedding_dim": 512,
    "dropout_rate": 0.2,
    "attention_heads": 8,
    "attention_dropout": 0.1,
    "classifier_hidden_dim": 128,
    "classifier_dropout": 0.3,
    "max_units_per_package": 100,
    "max_packages_per_batch": 32,
    "api_categories": [
      "net.outbound",
      "net.inbound",
      "fs.read",
      "fs.write",
      "fs.delete",
      "crypto.hash",
      "crypto.encrypt",
      "subprocess.spawn",
      "subprocess.shell",
      "eval.exec",
      "eval.compile",
      "env.read",
      "env.write",
      "install.hook",
      "install.script",
      "obfuscation.base64",
      "obfuscation.eval",
      "registry.access",
      "browser.access",
      "system.info"
    ],
    "entropy_thresholds": {
      "low": 3.0,
      "medium": 4.5,
      "high": 6.0,
      "very_high": 7.0
    }
  },
  "training_config": {
    "learning_rate": 0.0001,
    "weight_decay": 1e-05,
    "optimizer": "adamw",
    "curriculum_stages": {
      "stage_a": {
        "name": "balanced_training",
        "malicious_ratio": 0.2,
        "epochs": 20,
        "augmentation": false,
        "description": "Basic balanced training"
      },
      "stage_b": {
        "name": "augmented_training",
        "malicious_ratio": 0.2,
        "epochs": 15,
        "augmentation": true,
        "obfuscation_types": [
          "minify",
          "base64",
          "string_split"
        ],
        "description": "Add obfuscated variants"
      },
      "stage_c": {
        "name": "realistic_training",
        "malicious_ratio": 0.1,
        "epochs": 25,
        "augmentation": true,
        "description": "Real-world ratio training"
      }
    },
    "bce_weight": 1.0,
    "sparsity_weight": 0.01,
    "counterfactual_weight": 0.05,
    "patience": 10,
    "min_delta": 0.0001,
    "monitor_metric": "val_roc_auc",
    "batch_size": 2,
    "validation_split": 0.2,
    "test_split": 0.2,
    "augmentation_config": {
      "minify": {
        "probability": 0.3,
        "remove_whitespace": true,
        "remove_comments": true,
        "shorten_names": false
      },
      "base64": {
        "probability": 0.2,
        "encode_strings": true,
        "encode_full_functions": false
      },
      "string_split": {
        "probability": 0.25,
        "max_splits": 3,
        "min_length": 10
      }
    },
    "save_every_n_epochs": 5,
    "save_best_only": true,
    "checkpoint_dir": "checkpoints/amil"
  },
  "evaluation_config": {
    "target_roc_auc": 0.95,
    "target_fpr_at_95tpr": 0.02,
    "target_localization_iou": 0.7,
    "target_counterfactual_drop": 0.5,
    "top_k_attention": 3,
    "target_inference_latency": 2.0,
    "speed_test_samples": 100,
    "attention_percentiles": [
      50,
      75,
      90,
      95,
      99
    ],
    "visualize_attention": true,
    "save_attention_maps": true,
    "obfuscation_test_types": [
      "minified",
      "base64_encoded",
      "string_split",
      "variable_renamed"
    ],
    "test_cross_ecosystem": true,
    "confidence_interval": 0.95,
    "bootstrap_samples": 1000,
    "significance_level": 0.05
  }
}